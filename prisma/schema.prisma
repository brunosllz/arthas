generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Answer {
  id            String          @id @default(uuid())
  content       String
  authorId      String
  projectId     String
  createdAt     DateTime        @default(now())
  updatedAt     DateTime?       @updatedAt
  User          User            @relation(fields: [authorId], references: [id])
  project       Project         @relation(fields: [projectId], references: [id], onDelete: Cascade)
  answerComment AnswerComment[]
}

model AnswerComment {
  id        String    @id @default(uuid())
  content   String
  authorId  String
  answerId  String
  createdAt DateTime  @default(now())
  updatedAt DateTime? @updatedAt
  answer    Answer    @relation(fields: [answerId], references: [id], onDelete: Cascade)
  user      User      @relation(fields: [authorId], references: [id])
}

model Notification {
  id                String            @id @default(uuid())
  authorId          String
  recipientId       String
  createdAt         DateTime          @default(now())
  readAt            DateTime?
  title             String
  type              NOTIFICATION_TYPE
  ctaTitle          String[]
  linkTo            String
  authorIdToUser    User              @relation("NotificationAuthorIdToUser", fields: [authorId], references: [id])
  recipientIdToUser User              @relation("NotificationRecipientIdToUser", fields: [recipientId], references: [id])
}

model Project {
  id                  String                @id @default(uuid())
  authorId            String
  slug                String
  createdAt           DateTime              @default(now())
  updatedAt           DateTime?             @updatedAt
  imageUrl            String
  name                String
  status              PROJECT_STATUS
  meetingDate         String?
  meetingType         MEETING_TYPE
  requirements        String
  description         String
  meetingOccurredTime String
  answers             Answer[]
  InterestedInProject InterestedInProject[]
  users               User                  @relation(fields: [authorId], references: [id])
  projectRoles        ProjectRole[]
  teamMembers         TeamMember[]
  technologies        Technology[]          @relation("ProjectToTechnology")

  @@unique([authorId, slug])
}

model ProjectRole {
  id            String  @id @default(uuid())
  projectId     String
  roleId        String
  membersAmount Int
  project       Project @relation(fields: [projectId], references: [id], onDelete: Cascade)
  role          Role    @relation(fields: [roleId], references: [id])
  users         User[]  @relation("ProjectRoleToUser")

  @@unique([projectId, roleId])
}

model Role {
  id           String        @id @default(uuid())
  name         String        @unique
  projectRoles ProjectRole[]
}

model TeamMember {
  id             String                 @id @default(uuid())
  recipientId    String
  permissionType MEMBER_PERMISSION_TYPE
  status         MEMBER_STATUS
  projectId      String
  createdAt      DateTime               @default(now())
  updatedAt      DateTime?              @updatedAt
  project        Project                @relation(fields: [projectId], references: [id], onDelete: Cascade)
  user           User                   @relation(fields: [recipientId], references: [id])
}

model Technology {
  id       String    @id @default(uuid())
  slug     String    @unique
  projects Project[] @relation("ProjectToTechnology")
}

model User {
  id                        String                @id @default(uuid())
  name                      String
  email                     String                @unique
  avatarUrl                 String
  city                      String?
  state                     String?
  country                   String?
  linkedinLink              String?
  githubLink                String?
  createdAt                 DateTime              @default(now())
  updatedAt                 DateTime?             @updatedAt
  aboutMe                   String?
  overallRate               Decimal               @default(0.0) @db.Decimal(5, 2)
  profileUrl                String?               @unique
  role                      String?
  seniority                 String?
  slugProfile               String                @unique
  title                     String?
  onboard                   DateTime?
  account                   Account[]
  Answer                    Answer[]
  AnswerComment             AnswerComment[]
  InterestedInProject       InterestedInProject[]
  authorIdToNotifcation     Notification[]        @relation("NotificationAuthorIdToUser")
  recipientIdToNotification Notification[]        @relation("NotificationRecipientIdToUser")
  projects                  Project[]
  session                   Session[]
  teamMember                TeamMember[]
  projectRole               ProjectRole[]         @relation("ProjectRoleToUser")
  skills                    skill[]
}

model Account {
  id                String  @id @default(cuid())
  userId            String
  type              String
  provider          String
  providerAccountId String
  refreshToken      String?
  accessToken       String?
  expiresAt         Int?
  tokenType         String?
  scope             String?
  idToken           String?
  sessionState      String?
  user              User    @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@unique([provider, providerAccountId])
}

model Session {
  id           String   @id @default(uuid())
  sessionToken String   @unique
  userId       String
  expires      DateTime
  user         User     @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@index([userId])
}

model InterestedInProject {
  id         String   @id @default(uuid())
  userId     String
  projectId  String
  occurredAt DateTime @default(now())
  project    Project  @relation(fields: [projectId], references: [id])
  user       User     @relation(fields: [userId], references: [id])
}

model skill {
  id   String @id @default(uuid())
  slug String @unique
  user User[]
}

enum MEMBER_PERMISSION_TYPE {
  member
  owner
}

enum MEMBER_STATUS {
  pending
  rejected
  approved
}

enum PROJECT_STATUS {
  draft
  recruiting
  closed
}

enum MEETING_TYPE {
  daily
  weekly
  monthly
}

enum NOTIFICATION_TYPE {
  message
  action
  interaction
  info
}
